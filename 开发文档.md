# SmartPick 开发文档

SmartPick 是一个 Obsidian 插件，旨在提供智能的划词工具栏，支持自定义命令和 AI 功能。

## 项目结构

- `src/`: 源代码目录
  - `main.ts`: 插件入口
  - `settings.ts`: 设置数据结构定义
  - `i18n.ts`: 国际化支持
  - `toolbar/`: 工具栏 UI 实现
  - `commands/`: 命令管理与执行逻辑
  - `ui/`: 设置页面和模态框组件
  - `ai/`: AI 客户端与提供商实现

## 开发指南

### 环境准备

- Node.js
- npm

### 常用命令

- `npm run dev`: 启动开发模式，自动监听文件变更并编译。
- `npm run build`: 构建生产版本。
- `npm run lint`: 运行代码检查。

### 核心功能实现

#### 工具栏 (Toolbar)
工具栏在用户选中文本后自动浮现。位置计算逻辑在 `src/toolbar/Toolbar.ts` 中。

#### 命令系统 (CommandManager)
支持以下类型的命令：
1. **Obsidian 命令**: 调用 Obsidian 内部命令 ID。
2. **AI 命令**: 使用预定义的 Prompt 模板处理选中文本。
3. **URL/Link**: 打开外部链接或 URL Scheme。
4. **快捷键 (Shortcut)**: (v0.2.0+) 模拟系统键盘按键 (macOS only)。

#### 设置界面
设置界面使用 Obsidian 的 `PluginSettingTab` API，位于 `src/ui/SettingsTab.ts`。

## 版本发布流程

1. 更新 `manifest.json`, `package.json`, `versions.json` 中的版本号。
2. 运行 `npm run build` 生成最终的 `main.js`。
3. 更新 `CHANGELOG.md`。
4. 提交代码并发布。
